<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Consumo</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav class="navbar navbar-expand-lg border-bottom">
        <div class="container-fluid">
          <a class="navbar-brand ms-5" href="#"><img src="../img/Logonav.svg" width="180" height="45" alt="Logo"></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse row-gap-5 justify-content-end" id="navbarNav">
            <ul class="navbar-nav d-flex align-items-center gap-5 fw-semibold fs-5">
              <li class="nav-item">
                <a class="nav-link text-black" href="../index.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-black" href="produto.html">Produtos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-black" href="porque.html">Por que?</a>
              </li>
              <li class="nav-item">
                <a class="nav-link text-black" href="simular.html">Simular</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="entrar.html"><button type="button" class="btn btn-primary btn-lg fw-semibold fs-5 px-4">Entrar</button>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    <div class="container row m-3 g-2">
        <h2 class="text-start">Gastos</h2>
    </div>
    <div class="row mx-1">
        <div class="col-12 col-md-6 col-lg-4 pb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Por Aparelhos</h5>
                    <canvas id="graficoAparelhos"></canvas>
                    <p class="card-text"><small class="text-body-secondary">Atualizado em tempo real</small></p>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-6 col-lg-4 pb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Semana</h5>
                    <canvas id="graficoSemana"></canvas>
                    <p class="card-text"><small class="text-body-secondary">Atualizado em tempo real</small></p>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-6 col-lg-4 pb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Mês</h5>
                    <canvas id="graficoMes"></canvas>
                    <p class="card-text"><small class="text-body-secondary">Atualizado em tempo real</small></p>
                </div>
            </div>
    </div>
    <div class="row">
        <hr class="border-3 m-3">
    </div>
    <div class="container row m-3 g-2">
        <h2 class="text-start">Aparelhos</h2>
    </div>
    <div class="row mx-1">
        <div class="col-12 col-md-6 col-lg-4 pb-4 mb-3">
            <div class="card">
                <img src="../img/microondas.svg" class="card-img-top" alt="Imagem de um microondas">
                <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>Microondas</strong></li>
                <li class="list-group-item">Tarifa kWh: <input type="number" class="form-control tarifa" value="0.75" step="0.01"></li>
                <li class="list-group-item">Potência em watt: <input type="number" class="form-control potencia" value="1200"></li>
                <li class="list-group-item">Tempo em Horas: <input type="number" class="form-control tempo" value="0.5" step="0.1"></li>
                <li class="list-group-item">Consumo Diário: <span class="text-dark fw-bold consumo-diario">R$ 0,45</span></li>
                <li class="list-group-item">Consumo Mensal: <span class="text-dark fw-bold consumo-mensal">R$ 13,50</span></li>
                <li class="list-group-item"><button class="btn btn-primary w-100" onclick="atualizarGraficos()">Atualizar Gastos</button></li>
                </ul>
            </div>
        </div>
        <div class="col-12 col-md-6 col-lg-4 pb-4 mb-3">
            <div class="card">
                <img src="../img/ar-condicionado.svg" class="card-img-top" alt="Imagem de um ar-condicionado">
                <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>Ar-Condicionado</strong></li>
                <li class="list-group-item">Tarifa kWh: <input type="number" class="form-control tarifa" value="0.75" step="0.01"></li>
                <li class="list-group-item">Potência em watt: <input type="number" class="form-control potencia" value="1500"></li>
                <li class="list-group-item">Tempo em Horas: <input type="number" class="form-control tempo" value="8" step="0.1"></li>
                <li class="list-group-item">Consumo Diário: <span class="text-dark fw-bold consumo-diario">R$ 9,00</span></li>
                <li class="list-group-item">Consumo Mensal: <span class="text-dark fw-bold consumo-mensal">R$ 270,00</span></li>
                <li class="list-group-item"><button class="btn btn-primary w-100" onclick="atualizarGraficos()">Atualizar Gastos</button></li>
                </ul>
            </div>
        </div>
        <div class="col-12 col-md-6 col-lg-4 pb-4 mb-3">
            <div class="card">
                <img src="../img/chuveiro.svg" class="card-img-top" alt="Imagem de um chuveiro elétrico">
                <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>Chuveiro</strong></li>
                <li class="list-group-item">Tarifa kWh: <input type="number" class="form-control tarifa" value="0.75" step="0.01"></li>
                <li class="list-group-item">Potência em watt: <input type="number" class="form-control potencia" value="5500"></li>
                <li class="list-group-item">Tempo em Horas: <input type="number" class="form-control tempo" value="0.5" step="0.1"></li>
                <li class="list-group-item">Consumo Diário: <span class="text-dark fw-bold consumo-diario">R$ 2,06</span></li>
                <li class="list-group-item">Consumo Mensal: <span class="text-dark fw-bold consumo-mensal">R$ 61,80</span></li>
                <li class="list-group-item"><button class="btn btn-primary w-100" onclick="atualizarGraficos()">Atualizar Gastos</button></li>
                </ul>
            </div>
        </div>
        <div class="col-12 col-md-6 col-lg-4 pb-4 mb-3">
            <div class="card">
                <img src="../img/geladeira.svg" class="card-img-top" alt="Imagem de uma geladeira">
                <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>Geladeira</strong></li>
                <li class="list-group-item">Tarifa kWh: <input type="number" class="form-control tarifa" value="0.75" step="0.01"></li>
                <li class="list-group-item">Potência em watt: <input type="number" class="form-control potencia" value="250"></li>
                <li class="list-group-item">Tempo em Horas: <input type="number" class="form-control tempo" value="24" step="0.1"></li>
                <li class="list-group-item">Consumo Diário: <span class="text-dark fw-bold consumo-diario">R$ 4,50</span></li>
                <li class="list-group-item">Consumo Mensal: <span class="text-dark fw-bold consumo-mensal">R$ 135,00</span></li>
                <li class="list-group-item"><button class="btn btn-primary w-100" onclick="atualizarGraficos()">Atualizar Gastos</button></li>
                </ul>
            </div>
        </div>
        <div class="col-12 col-md-6 col-lg-4 pb-4 mb-3">
            <div class="card">
                <img src="../img/televisao.svg" class="card-img-top" alt="Imagem de uma televisão">
                <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>Televisão</strong></li>
                <li class="list-group-item">Tarifa kWh: <input type="number" class="form-control tarifa" value="0.75" step="0.01"></li>
                <li class="list-group-item">Potência em watt: <input type="number" class="form-control potencia" value="100"></li>
                <li class="list-group-item">Tempo em Horas: <input type="number" class="form-control tempo" value="6" step="0.1"></li>
                <li class="list-group-item">Consumo Diário: <span class="text-dark fw-bold consumo-diario">R$ 0,45</span></li>
                <li class="list-group-item">Consumo Mensal: <span class="text-dark fw-bold consumo-mensal">R$ 13,50</span></li>
                <li class="list-group-item"><button class="btn btn-primary w-100" onclick="atualizarGraficos()">Atualizar Gastos</button></li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        let graficoAparelhos, graficoSemana, graficoMes;

        function atualizarGraficos() {
            setTimeout(() => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, 500);

            const cards = document.querySelectorAll('.card');
            
            const labels = [];
            const dadosConsumoMensal = [];
            const dadosConsumoDiario = [];
            
            cards.forEach(card => {
                const nome = card.querySelector('strong');
                if (!nome) return;
                
                const tarifa = parseFloat(card.querySelector('.tarifa')?.value) || 0;
                const potencia = parseFloat(card.querySelector('.potencia')?.value) || 0;
                const tempo = parseFloat(card.querySelector('.tempo')?.value) || 0;
                
                const consumoDiario = ((potencia / 1000) * tempo * tarifa);
                const consumoMensal = consumoDiario * 30;
                
                const consumoDiarioSpan = card.querySelector('.consumo-diario');
                const consumoMensalSpan = card.querySelector('.consumo-mensal');
                
                if (consumoDiarioSpan && consumoMensalSpan) {
                    consumoDiarioSpan.textContent = `R$ ${consumoDiario.toFixed(2).replace('.', ',')}`;
                    consumoMensalSpan.textContent = `R$ ${consumoMensal.toFixed(2).replace('.', ',')}`;
                }
                
                labels.push(nome.textContent);
                dadosConsumoMensal.push(consumoMensal);
                dadosConsumoDiario.push(consumoDiario);
            });

            if (graficoAparelhos) graficoAparelhos.destroy();
            if (graficoSemana) graficoSemana.destroy();
            if (graficoMes) graficoMes.destroy();

            const ctxAparelhos = document.getElementById('graficoAparelhos').getContext('2d');
            graficoAparelhos = new Chart(ctxAparelhos, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: dadosConsumoMensal,
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56',
                            '#4BC0C0',
                            '#9966FF'
                        ]
                    }]
                }
            });

            const ctxSemana = document.getElementById('graficoSemana').getContext('2d');
            const diasSemana = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
            
            const datasets = labels.map((label, index) => {
                const dadosSemana = diasSemana.map(() => {
                    const variacao = 0.7 + Math.random() * 0.6;
                    return dadosConsumoDiario[index] * variacao;
                });

                return {
                    label: label,
                    data: dadosSemana,
                    borderColor: [
                        '#FF6384',
                        '#36A2EB',
                        '#FFCE56',
                        '#4BC0C0',
                        '#9966FF'
                    ][index],
                    fill: false,
                    tension: 0.4
                };
            });

            graficoSemana = new Chart(ctxSemana, {
                type: 'line',
                data: {
                    labels: diasSemana,
                    datasets: datasets
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Consumo Diário (R$)'
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        tooltip: {
                            position: 'nearest'
                        }
                    }
                }
            });

            const ctxMes = document.getElementById('graficoMes').getContext('2d');
            graficoMes = new Chart(ctxMes, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Consumo Mensal (R$)',
                        data: dadosConsumoMensal,
                        backgroundColor: '#4BC0C0'
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        document.addEventListener('DOMContentLoaded', atualizarGraficos);
    </script>
    
</body>
</html>